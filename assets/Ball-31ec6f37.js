import{B as H,V as C,M as z,F as D,r as u,a as I,E as P,b as G,O as N,_ as $,u as X,m as Z,c as q,j as y,C as J,d as K,e as Q,P as Y,f as v,T as U,S as V}from"./index-66c064c9.js";class tt extends H{constructor(h,l,w,s){super();const x=[],A=[],R=[],p=new C,b=new z;b.makeRotationFromEuler(w),b.setPosition(l);const j=new z;j.copy(b).invert(),E(),this.setAttribute("position",new D(x,3)),this.setAttribute("normal",new D(A,3)),this.setAttribute("uv",new D(R,2));function E(){let t,e=[];const r=new C,a=new C;if(h.geometry.isGeometry===!0){console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");return}const o=h.geometry,L=o.attributes.position,g=o.attributes.normal;if(o.index!==null){const f=o.index;for(t=0;t<f.count;t++)r.fromBufferAttribute(L,f.getX(t)),a.fromBufferAttribute(g,f.getX(t)),B(e,r,a)}else for(t=0;t<L.count;t++)r.fromBufferAttribute(L,t),a.fromBufferAttribute(g,t),B(e,r,a);for(e=i(e,p.set(1,0,0)),e=i(e,p.set(-1,0,0)),e=i(e,p.set(0,1,0)),e=i(e,p.set(0,-1,0)),e=i(e,p.set(0,0,1)),e=i(e,p.set(0,0,-1)),t=0;t<e.length;t++){const f=e[t];R.push(.5+f.position.x/s.x,.5+f.position.y/s.y),f.position.applyMatrix4(b),x.push(f.position.x,f.position.y,f.position.z),A.push(f.normal.x,f.normal.y,f.normal.z)}}function B(t,e,r){e.applyMatrix4(h.matrixWorld),e.applyMatrix4(j),r.transformDirection(h.matrixWorld),t.push(new F(e.clone(),r.clone()))}function i(t,e){const r=[],a=.5*Math.abs(s.dot(e));for(let o=0;o<t.length;o+=3){let L,g,f,k=0,c,m,M,S;const W=t[o+0].position.dot(e)-a,T=t[o+1].position.dot(e)-a,_=t[o+2].position.dot(e)-a;switch(L=W>0,g=T>0,f=_>0,k=(L?1:0)+(g?1:0)+(f?1:0),k){case 0:{r.push(t[o]),r.push(t[o+1]),r.push(t[o+2]);break}case 1:{if(L&&(c=t[o+1],m=t[o+2],M=d(t[o],c,e,a),S=d(t[o],m,e,a)),g){c=t[o],m=t[o+2],M=d(t[o+1],c,e,a),S=d(t[o+1],m,e,a),r.push(M),r.push(m.clone()),r.push(c.clone()),r.push(m.clone()),r.push(M.clone()),r.push(S);break}f&&(c=t[o],m=t[o+1],M=d(t[o+2],c,e,a),S=d(t[o+2],m,e,a)),r.push(c.clone()),r.push(m.clone()),r.push(M),r.push(S),r.push(M.clone()),r.push(m.clone());break}case 2:{L||(c=t[o].clone(),m=d(c,t[o+1],e,a),M=d(c,t[o+2],e,a),r.push(c),r.push(m),r.push(M)),g||(c=t[o+1].clone(),m=d(c,t[o+2],e,a),M=d(c,t[o],e,a),r.push(c),r.push(m),r.push(M)),f||(c=t[o+2].clone(),m=d(c,t[o],e,a),M=d(c,t[o+1],e,a),r.push(c),r.push(m),r.push(M));break}}}return r}function d(t,e,r,a){const o=t.position.dot(r)-a,L=e.position.dot(r)-a,g=o/(o-L);return new F(new C(t.position.x+g*(e.position.x-t.position.x),t.position.y+g*(e.position.y-t.position.y),t.position.z+g*(e.position.z-t.position.z)),new C(t.normal.x+g*(e.normal.x-t.normal.x),t.normal.y+g*(e.normal.y-t.normal.y),t.normal.z+g*(e.normal.z-t.normal.z)))}}}class F{constructor(h,l){this.position=h,this.normal=l}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}function et(n){return Array.isArray(n)}function O(n=[0,0,0]){return et(n)?n:n instanceof C||n instanceof P?[n.x,n.y,n.z]:[n,n,n]}const ot=u.forwardRef(function({debug:h,mesh:l,children:w,position:s,rotation:x,scale:A,...R},p){const b=u.useRef(null);u.useImperativeHandle(p,()=>b.current);const j=u.useRef(null);return u.useLayoutEffect(()=>{const E=(l==null?void 0:l.current)||b.current.parent,B=b.current;if(!(E instanceof I))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');const i={position:new C,rotation:new P,scale:new C(1,1,1)};if(E){G(i,{position:s,scale:A});const d=E.matrixWorld.clone();if(E.matrixWorld.identity(),!x||typeof x=="number"){const t=new N;t.position.copy(i.position),t.lookAt(E.position),typeof x=="number"&&t.rotateZ(x),G(i,{rotation:t.rotation})}else G(i,{rotation:x});return B.geometry=new tt(E,i.position,i.rotation,i.scale),j.current&&G(j.current,i),E.matrixWorld=d,()=>{B.geometry.dispose()}}},[l,...O(s),...O(A),...O(x)]),u.createElement("mesh",{ref:b},w||u.createElement("meshStandardMaterial",$({transparent:!0,polygonOffset:!0,polygonOffsetFactor:-10},R)),h&&u.createElement("mesh",{ref:j},u.createElement("boxGeometry",null),u.createElement("meshNormalMaterial",{wireframe:!0}),u.createElement("axesHelper",null)))}),rt=u.forwardRef(({children:n,enabled:h=!0,speed:l=1,rotationIntensity:w=1,floatIntensity:s=1,floatingRange:x=[-.1,.1],...A},R)=>{const p=u.useRef(null),b=u.useRef(Math.random()*1e4);return X(j=>{var E,B;if(!h||l===0)return;const i=b.current+j.clock.getElapsedTime();p.current.rotation.x=Math.cos(i/4*l)/8*w,p.current.rotation.y=Math.sin(i/4*l)/8*w,p.current.rotation.z=Math.sin(i/4*l)/20*w;let d=Math.sin(i/4*l)/10;d=q.mapLinear(d,-.1,.1,(E=x==null?void 0:x[0])!==null&&E!==void 0?E:-.1,(B=x==null?void 0:x[1])!==null&&B!==void 0?B:.1),p.current.position.y=d*s,p.current.updateMatrix()}),u.createElement("group",A,u.createElement("group",{ref:Z([p,R]),matrixAutoUpdate:!1},n))}),nt=({imgUrl:n,position:h=[0,0,0]})=>{let l=null;const w=u.useMemo(()=>typeof n=="string"&&n.length>0?n:n!=null&&n.src?n.src:n!=null&&n.default?n.default:null,[n]);try{w&&(l=v(U,w),l&&(l.colorSpace=V))}catch(s){console.warn(`Failed to load texture: ${w}`,s)}return y.jsxs(rt,{speed:1.75,rotationIntensity:1,floatIntensity:2,children:[y.jsx("ambientLight",{intensity:.25}),y.jsx("directionalLight",{position:[0,0,.05]}),y.jsxs("mesh",{position:h,castShadow:!0,receiveShadow:!0,scale:2.75,children:[y.jsx("icosahedronGeometry",{args:[1,1]}),y.jsx("meshStandardMaterial",{color:"#fff8eb",polygonOffset:!0,polygonOffsetFactor:-5,flatShading:!0}),l&&y.jsx(ot,{position:[0,0,1],rotation:[0,0,0],scale:1,map:l,flatShading:!0})]})]})},st=({imgUrl:n,position:h=[0,0,0]})=>y.jsx(nt,{imgUrl:n,position:h}),lt=({icon:n})=>{const h=u.useRef(null),[l,w]=u.useState(!1);return u.useEffect(()=>{const s=h.current;if(!s)return;const x=()=>{w(!0)},A=()=>{w(!1)};return s.addEventListener("webglcontextlost",x),s.addEventListener("webglcontextrestored",A),()=>{var p,b,j;s.removeEventListener("webglcontextlost",x),s.removeEventListener("webglcontextrestored",A);const R=((p=s==null?void 0:s.getContext)==null?void 0:p.call(s,"webgl2"))||((b=s==null?void 0:s.getContext)==null?void 0:b.call(s,"webgl"));R&&((j=R.getExtension("WEBGL_lose_context"))==null||j.loseContext())}},[]),l?y.jsx("div",{className:"w-full h-full bg-gray-700 rounded-full"}):y.jsxs(J,{ref:h,className:"w-full h-full",frameloop:"auto",dpr:[1,1.2],gl:{preserveDrawingBuffer:!1,powerPreference:"high-performance",antialias:!0,alpha:!0,failIfMajorPerformanceCaveat:!0},onCreated:s=>{s.gl.info.autoReset=!0},children:[y.jsxs(u.Suspense,{fallback:y.jsx(K,{}),children:[y.jsx(Q,{enableZoom:!1}),y.jsx(st,{imgUrl:n})]}),y.jsx(Y,{all:!0})]})};export{st as Ball,lt as default};
